@desktop_cancel_booking_test
Feature: Cancel Booking Desktop Screen Test in NueGo (Greencell)

  Background:
    * configure driver = { type: 'chrome', addOptions: ['--incognito', '--disable-geolocation'] }

  Scenario: Cancel Booking in NueGo Web (Greencell) Test
    # Background URL
    Given driver 'https://greencell-nuego-web.web.app/'
    * maximize()
    # Login with mobile number
    And click("//img[@class='display-block margin-left-18 cursor-pointer']")
    And click("//p[@class='ubuntu-700w-18s-28h cursor-pointer mb-0   active-tab']")
    And input("input[placeholder='Enter your number']", '9677971057', 60)
    * delay(1000).screenshot()
    When click("//button[@class='teal-22BBB0-bg submit-button w-100 mb-3']")
    # Input valid OTP
    * def elements = locateAll("//input[@maxlength='1']")
    * match karate.sizeOf(elements) == 4
    * delay(38000)
    And click("//button[@class='teal-22BBB0-bg white-color open-600w-16s-24h p-3 w-100 submit-button mb-3']")
    * delay(1000).screenshot()
    * delay(1500)
    * dialog(true, 'Successfully login')
    And click("//p[@class='open-400w-14s-22h mb-0 whitespace-nowrap cursor-pointer  white-color ']")
    * delay(1000).screenshot()
    And click("//div[@class='viewTickets ubuntu-500w-18s-28h']")
    * delay(1500)

    # Cancel the booking
    Then waitForUrl("https://greencell-nuego-web.web.app/confirmation")
    * scroll('{p}Change booking').click()
    * delay(2000)
    And click('{p}Cancel')
    * delay(1000)
    * def cancelReasons = locateAll("//img[@src='/static/media/inactive-radio-icon.278bbd0a47c318ab6bce3e616b51d827.svg']")
    * cancelReasons[0].click()
    * delay(1000).screenshot()
    * scroll('{p}Please select Passengers')
    * def passengers = locateAll("//p[@class='open-600w-16s-24h opacity-100']")
    * passengers[0].click()
    * def psName1 = locateAll('{}selvam')
    * psName1[1].click()
    * def psName2 = locateAll('{}ganesh')
    * psName2[1].click()
    * delay(1000).screenshot()
    * scroll('{p}Total Refund')
    * delay(1000)
    And click("//button[@class='submit-button']")
    * delay(1000)
    Then waitForUrl('https://greencell-nuego-web.web.app/confirmation')
    And click("//img[@class='icon-24 mr-2']")
    * delay(1000).screenshot()
    * delay(1000)
    And click('{button}Refund')
    * delay(1000).screenshot()
    * close()

#    And click('{p}Cancel Ticket')
#    * delay(1000).screenshot()
#    * def cancelTickets = locateAll("//p[@class='open-600w-16s-24h opacity-60']")
#    * cancelTickets[0].click()
#    * delay(1000)
#    * def cancelTickets = locateAll("//p[@class='open-600w-16s-24h opacity-60']")
#    * cancelTickets[1].click()
#    * delay(1500)
#    * scroll('{p}Total Refund')
#    * delay(1500)
#    And click("//button[@class='submit-button']")
#    * delay(2500)
#    * def mode = locate("//img[@class='icon-24 mr-2']")
#    * mode.click()
#    * delay(2500)
#    And click("//button[@class='submit-button']")
#    * delay(2000).screenshot()

##    And click("//div[@class='common-input-wrap d-flex justify-content-between date-input align-items-center mb-2 cursor-pointer']")
##    * delay(1000)
##    And click("//button[@class='react-calendar__navigation__arrow react-calendar__navigation__next-button']")
##    * delay(1000)
##    And click('{p}View Coaches')
##    * delay(3000)
##    Then waitForUrl("https://greencell-nuego-web.web.app/booking")
##    * delay(1000)
##    And click('{p}Select Seats')
##    * delay(1000)
##    And click('{p}ISBT Kashmere Gate')
##    * delay(1000)
##    And click('{p}Dropping Point')
##    * delay(1000)
##    And click('{p}ISBT Amritsar')
##    * def seats = locateAll("//div[@class=' w-fit-content seat-listing-seat']")
##    * match karate.sizeOf(seats) == 55
##    * seats[24].click()
##    * def seats = locateAll("//div[@class=' w-fit-content seat-listing-seat']")
##    * seats[28].click()
##    * delay(2000)
##    * scroll('{button}Book & Pay')
##    * delay(1000)
##    And click("//button[@class='submit-button ubuntu-500w-18s-28h w-100 py-3 mt-3 ']")
###   Then waitForUrl('https://greencell-nuego-web.web.app/booking-details')
##    * delay(2000)
##    * scroll('{p}Payment Options')
##    * delay(2000)
##    And click("//img[@src='/static/media/pine-labs-logo.61cb4280a042843dc8ef2d7dfdfcceaa.svg']")
##    * delay(1000)
##    And click("//button[@class='teal-22BBB0-bg cursor-pointer white-color submit-button text-center open-600w-16s-24h py-3']")
##    * delay(8000).screenshot()
##    # Payment page
###    Then waitForUrl('https://greencell-nuego-web.web.app/booking-details')
###    * scroll('{p}Payment Options')
###    * delay(1000)
###    And click("//p[@class=' mb-0 ml-2 open-400w-16s-22h opacity-60']")
###    * delay(1000)
###    And click("//button[@class='teal-22BBB0-bg cursor-pointer white-color submit-button text-center open-600w-16s-24h py-3']")
###    * delay(6000).screenshot()
###    Then waitForUrl('https://uat.pinepg.in/card')
##    And click('{span}Net Banking')
##    * delay(1000)
##    And click('{span}IDBI Bank')
##    * delay(1000)
##    And click("//button[@class='btn btn-green mr-3']")
##    * delay(7000)
##    Then waitForUrl('https://uat.billdesk.com/pgidsk/pgijsp/banksimulator.jsp')
##    When waitFor('#BankStatus').click()
##    And select('#BankStatus', '{}Success')
##    And click('#SubmitForm')
##    * delay(9000).screenshot()
##    * close()