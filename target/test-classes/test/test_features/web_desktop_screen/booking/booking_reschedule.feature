@desktop_booking_reschedule_test
Feature: Booking Reschedule Desktop Screen Test in NueGo (Greencell)

  Background:
    * configure driver = { type: 'chrome', addOptions: ['--incognito', '--disable-geolocation'] }

  Scenario: Booking Reschedule (change booking) Test
    # Background URL
    Given driver 'https://greencell-nuego-web.web.app/'
    * maximize()
    # Login with mobile number
    And click("//img[@class='display-block margin-left-18 cursor-pointer']")
    And click("//p[@class='ubuntu-700w-18s-28h cursor-pointer mb-0   active-tab']")
    And input("input[placeholder='Enter your number']", '9677971057', 60)
    * delay(1000).screenshot()
    When click("//button[@class='teal-22BBB0-bg submit-button w-100 mb-3']")
    # Input valid OTP
    * def elements = locateAll("//input[@maxlength='1']")
    * match karate.sizeOf(elements) == 4
    * delay(35000)
    * delay(1000).screenshot()
    When click("//button[@class='teal-22BBB0-bg white-color open-600w-16s-24h p-3 w-100 submit-button mb-3']")
    # Then Expect the Success message
    * dialog(true, 'Successfully Login')
    * delay(1000).screenshot()
    # Booking Reschedule
    * delay(2000)
    * click("//p[@class='open-400w-14s-22h mb-0 whitespace-nowrap cursor-pointer  white-color ']")
    * delay(3000)
    * click("//div[@class='viewTickets ubuntu-500w-18s-28h']")
    * delay(1500)    
    Then waitForUrl("https://greencell-nuego-web.web.app/confirmation")
    * scroll('{p}Change booking').click()
    * delay(2000)
    And click('{p}Reschedule')
    * delay(1000)
    And click("//div[@class='common-input-wrap d-flex justify-content-between date-input align-items-center mb-2 cursor-pointer']")
    * delay(1000)
    And click("//button[@class='react-calendar__navigation__arrow react-calendar__navigation__next-button']")
    * delay(1000)
    And click('{p}View Coaches')
    * delay(3000)
    Then waitForUrl("https://greencell-nuego-web.web.app/booking")
    * delay(1000)
    And click('{p}Select Seats')
    * delay(1000)
    And click('{p}ISBT Kashmere Gate')
    * delay(1000)
    And click('{p}Dropping Point')
    * delay(1000)
    And click('{p}ISBT Amritsar')
    * def seats = locateAll("//div[@class=' w-fit-content seat-listing-seat']")
    * match karate.sizeOf(seats) == 55
    * seats[24].click()
    * def seats = locateAll("//div[@class=' w-fit-content seat-listing-seat']")
    * seats[28].click()
    * delay(2000)
    * scroll('{button}Book & Pay')
    * delay(1000)
    And click("//button[@class='submit-button ubuntu-500w-18s-28h w-100 py-3 mt-3 ']")
#    Then waitForUrl('https://greencell-nuego-web.web.app/booking-details')
    * delay(2000)
    * scroll('{p}Payment Options')
    * delay(2000)
    And click("//img[@src='/static/media/pine-labs-logo.61cb4280a042843dc8ef2d7dfdfcceaa.svg']")
    * delay(1000)
    And click("//button[@class='teal-22BBB0-bg cursor-pointer white-color submit-button text-center open-600w-16s-24h py-3']")
    * delay(8000).screenshot()
    # Payment page
#    Then waitForUrl('https://greencell-nuego-web.web.app/booking-details')
#    * scroll('{p}Payment Options')
#    * delay(1000)
#    And click("//p[@class=' mb-0 ml-2 open-400w-16s-22h opacity-60']")
#    * delay(1000)
#    And click("//button[@class='teal-22BBB0-bg cursor-pointer white-color submit-button text-center open-600w-16s-24h py-3']")
#    * delay(6000).screenshot()
    Then waitForUrl('https://uat.pinepg.in/card')
    And click('{span}Net Banking')
    * delay(1000)
    And click('{span}IDBI Bank')
    * delay(1000)
    And click("//button[@class='btn btn-green mr-3']")
    * delay(7000)
    Then waitForUrl('https://uat.billdesk.com/pgidsk/pgijsp/banksimulator.jsp')
    When waitFor('#BankStatus').click()
    And select('#BankStatus', '{}Success')
    And click('#SubmitForm')
    * delay(9000).screenshot()
    * close()